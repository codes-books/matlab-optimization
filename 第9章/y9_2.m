clc% 清屏
clear all;%删除workplace变量
close all;%关掉显示图形窗口
A=[	
0.037 	0.031 	0.098 	0.030 	0.032 	0.058 	0.029 	0.028 	0.028 	0.025 	0.034 	0.108 
0.034 	0.027 	0.067 	0.034 	0.032 	0.060 	0.029 	0.024 	0.059 	0.028 	0.028 	0.094 
0.027 	0.025 	0.039 	0.018 	0.028 	0.052 	0.014 	0.020 	0.031 	0.011 	0.023 	0.061 
0.040 	0.035 	0.067 	0.039 	0.042 	0.065 	0.047 	0.033 	0.033 	0.036 	0.045 	0.090 
0.035 	0.030 	0.076 	0.036 	0.041 	0.068 	0.011 	0.036 	0.040 	0.025 	0.039 	0.106 
0.027 	0.021 	0.056 	0.025 	0.030 	0.041 	0.000 	0.000 	0.000 	0.010 	0.025 	0.080 
0.026 	0.023 	0.047 	0.023 	0.029 	0.048 	0.011 	0.019 	0.024 	0.013 	0.027 	0.081 
0.026 	0.023 	0.061 	0.017 	0.028 	0.050 	0.007 	0.021 	0.037 	0.014 	0.027 	0.070 
0.027 	0.019 	0.051 	0.010 	0.030 	0.034 	0.005 	0.008 	0.015 	0.010 	0.020 	0.050 
0.025 	0.018 	0.038 	0.009 	0.023 	0.024 	0.005 	0.014 	0.011 	0.009 	0.015 	0.037 
0.036 	0.024 	0.061 	0.013 	0.028 	0.031 	0.011 	0.025 	0.019 	0.015 	0.026 	0.061 
0.028 	0.017 	0.055 	0.016 	0.027 	0.034 	0.006 	0.013 	0.017 	0.011 	0.021 	0.062 
0.032 	0.025 	0.050 	0.023 	0.033 	0.042 	0.005 	0.023 	0.022 	0.014 	0.025 	0.060 
0.035 	0.019 	0.049 	0.051 	0.040 	0.046 	0.014 	0.028 	0.029 	0.016 	0.025 	0.061 
0.037 	0.027 	0.074 	0.081 	0.054 	0.052 	0.017 	0.037 	0.034 	0.019 	0.041 	0.082 
0.044 	0.031 	0.128 	0.100 	0.062 	0.094 	0.013 	0.036 	0.077 	0.019 	0.047 	0.136 
0.029 	0.029 	0.102 	0.019 	0.041 	0.071 	0.003 	0.048 	0.067 	0.005 	0.040 	0.111 
0.033 	0.026 	0.085 	0.019 	0.031 	0.059 	0.006 	0.031 	0.060 	0.005 	0.030 	0.094 
0.031 	0.023 	0.095 	0.009 	0.023 	0.054 	0.004 	0.032 	0.053 	0.003 	0.022 	0.078 
0.045 	0.023 	0.129 	0.017 	0.029 	0.084 	0.017 	0.023 	0.057 	0.022 	0.034 	0.158 
0.032 	0.022 	0.105 	0.011 	0.026 	0.066 	0.009 	0.015 	0.050 	0.014 	0.026 	0.123 
0.033 	0.021 	0.068 	0.020 	0.022 	0.047 	0.021 	0.025 	0.029 	0.018 	0.022 	0.085 
0.033 	0.024 	0.075 	0.018 	0.029 	0.043 	0.016 	0.020 	0.028 	0.016 	0.027 	0.071 
0.056 	0.035 	0.100 	0.036 	0.038 	0.048 	0.042 	0.033 	0.033 	0.033 	0.040 	0.125 
0.059 	0.041 	0.101 	0.045 	0.051 	0.089 	0.077 	0.046 	0.054 	0.032 	0.047 	0.118 
0.065 	0.049 	0.148 	0.081 	0.052 	0.127 	0.054 	0.055 	0.084 	0.037 	0.000 	0.157 
0.051 	0.030 	0.068 	0.029 	0.039 	0.052 	0.013 	0.032 	0.054 	0.010 	0.032 	0.079 
0.044 	0.021 	0.101 	0.010 	0.026 	0.081 	0.030 	0.018 	0.062 	0.014 	0.014 	0.128 
0.066 	0.024 	0.062 	0.011 	0.032 	0.049 	0.017 	0.018 	0.022 	0.017 	0.027 	0.079 
0.035 	0.018 	0.053 	0.008 	0.023 	0.049 	0.008 	0.009 	0.021 	0.009 	0.004 	0.045 
0.052 	0.023 	0.038 	0.046 	0.025 	0.042 	0.019 	0.013 	0.020 	0.024 	0.014 	0.060 
0.045 	0.025 	0.030 	0.056 	0.028 	0.038 	0.025 	0.017 	0.020 	0.023 	0.016 	0.050 
0.057 	0.034 	0.063 	0.061 	0.041 	0.050 	0.063 	0.031 	0.030 	0.019 	0.027 	0.082 
0.076 	0.043 	0.093 	0.094 	0.055 	0.081 	0.030 	0.047 	0.049 	0.027 	0.058 	0.035 
0.073 	0.036 	0.089 	0.000 	0.067 	0.085 	0.020 	0.021 	0.058 	0.020 	0.025 	0.000 
0.056 	0.028 	0.077 	0.000 	0.057 	0.073 	0.009 	0.020 	0.040 	0.013 	0.019 	0.000 
0.070 	0.031 	0.051 	0.035 	0.037 	0.045 	0.031 	0.029 	0.025 	0.024 	0.031 	0.092 
0.049 	0.029 	0.061 	0.019 	0.028 	0.044 	0.013 	0.024 	0.033 	0.008 	0.028 	0.056 
0.034 	0.026 	0.041 	0.019 	0.031 	0.041 	0.004 	0.032 	0.018 	0.007 	0.031 	0.051 
0.037 	0.040 	0.096 	0.038 	0.050 	0.073 	0.013 	0.052 	0.032 	0.020 	0.057 	0.130 
0.026 	0.027 	0.058 	0.028 	0.030 	0.044 	0.000 	0.000 	0.000 	0.012 	0.035 	0.047 
0.023 	0.029 	0.065 	0.066 	0.027 	0.050 	0.011 	0.042 	0.035 	0.009 	0.034 	0.045 
0.034 	0.031 	0.079 	0.091 	0.038 	0.066 	0.023 	0.035 	0.031 	0.028 	0.044 	0.100 
0.022 	0.028 	0.050 	0.071 	0.033 	0.040 	0.003 	0.046 	0.029 	0.004 	0.033 	0.038 
0.032 	0.043 	0.063 	0.049 	0.046 	0.056 	0.011 	0.032 	0.015 	0.017 	0.048 	0.070 
0.033 	0.035 	0.078 	0.011 	0.031 	0.057 	0.006 	0.034 	0.034 	0.005 	0.041 	0.064 
0.024 	0.031 	0.057 	0.004 	0.032 	0.055 	0.004 	0.019 	0.037 	0.003 	0.036 	0.032 
0.029 	0.030 	0.040 	0.006 	0.032 	0.040 	0.004 	0.015 	0.024 	0.004 	0.029 	0.021 
0.024 	0.052 	0.109 	0.010 	0.050 	0.078 	0.004 	0.031 	0.033 	0.006 	0.060 	0.099 
0.022 	0.026 	0.052 	0.027 	0.028 	0.046 	0.003 	0.012 	0.031 	0.013 	0.027 	0.035 
0.030 	0.043 	0.068 	0.063 	0.045 	0.069 	0.013 	0.049 	0.031 	0.023 	0.056 	0.000 
0.041 	0.037 	0.075 	0.039 	0.036 	0.044 	0.018 	0.037 	0.020 	0.021 	0.047 	0.064 
0.068 	0.036 	0.060 	0.061 	0.031 	0.047 	0.013 	0.038 	0.032 	0.014 	0.038 	0.054 
0.024 	0.028 	0.041 	0.059 	0.022 	0.033 	0.011 	0.018 	0.022 	0.013 	0.022 	0.042 
0.022 	0.025 	0.037 	0.057 	0.021 	0.027 	0.004 	0.018 	0.013 	0.012 	0.018 	0.029 
];
ca=[0.1,0.335,0.1];%中值
ca1=[0.5341  0.4492  0.5341];%δ的值
B=[0.2 0.6 1;0.67 0.67 1;0.2 0.6 1];%标准分级
a=size(A,1);%A的行数
b=size(A,2);%A的列数
MX=max(A);%A的每列的最大值
MN=min(A);%A的每列的最小值
f1=1;%B的行变量
f2=1;%B的列变量
for j=1:b%将A里面的值标准化
    for i=1:a
        A(i,j)=(A(i,j)-MN(j))/(MX(j)-MN(j));
    end
end
X=zeros(a,4);%建立放置每个城市每天空气质量的值矩阵
for i=1:a%计算每个城市每天的空气质量
    h=1;
    k=1;
    flag0=1;%算完每个城市每天的空气质量后，跳到下一个城市（h=h+1）
    for j=1:b 
        for flag=1:3
            if A(i,j)<=ca(k)
              w=0;
              X(i,h)=X(i,h);
              break;
            elseif A(i,j)>ca(k)&&A(i,j)<B(f1,f2)
                w=1-exp(-(A(i,j)-ca(k)/ca1(k))^2);
                X(i,h)=X(i,h)+w*A(i,j);%加权
                break;
            else
                k=k+1;%对应每个中值
                f2=f2+1;%对应每个等级值
            end
        end
        f1=f1+1;%对应每个属性
        k=1;%每循环完一次，跳到第一个中值
        f2=1;%每循环完一次，又从第一级开始
        if flag0==3%判断是否算完了一个城市每天的空气质量
            h=h+1;
            flag0=1;
            f1=1;
        else
        flag0=flag0+1;
        end
    end
end
a=size(X,1);%X的行数
b=size(X,2);%X的列数
h=1;
C=zeros(1,b);%建立总体排序矩阵
for k=1:b%将所有城市总体排序
    for i=1:a
        for j=1:b
            if(A(h)>A(i,j))
                C(k)= C(k)+1;
            else
            end
        end
        h=h+1;
    end
end
C % Borda数